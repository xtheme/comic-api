!function(t,e){"use strict";function a(t,e){let a=t.attr("href"),c=new URLSearchParams(a);$.confirm({text:`请确认是否要${t.attr("title")}?`,callback:function(){$.request({url:a,type:e,data:0===Object.keys(c).length?null:c,callback:function(t){parent.$.reloadIFrame({title:t.msg})}})}})}$(".upload-image").on("click",(function(){$(".hidden-file-upload").trigger("click")})),$(".hidden-file-upload").on("change",(function(){var t=$(this),e=new FormData;e.append("image",t.get(0).files[0]),$.ajax({url:`/upload/${t.attr("data-path")}`,type:"post",cache:!1,contentType:!1,processData:!1,dataType:"json",data:e,headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},success:function(e){console.log(e),200==e.code?(t.parents(".form-group").find(".upload-image-callback").empty().append(`<img src="${e.data.domain}${e.data.path}" alt="">`).show(),t.parents(".form-group").find(".image-path").val(e.data.path)):$.toast({type:"error",message:e.msg})},error:function(t){var e=JSON.parse(t.responseText);parent.$.toast({type:"error",message:e.msg})}})})),$("[data-modal]").on("click",(function(t){t.preventDefault();let e=$(this);$.openModal({size:e.data("size")||"xl",height:e.data("height")||"50vh",title:e.attr("title"),url:e.attr("href")})})),$("[data-lightbox]").on("click",(function(t){t.preventDefault();let e=$(this);$.openImage({size:e.data("size")||"",height:e.data("height")||"30vh",title:"检视图片",image:e.attr("src")})})),$("[data-confirm]").on("click",(function(t){t.preventDefault(),a($(this),"put")})),$("[data-destroy]").on("click",(function(t){t.preventDefault(),a($(this),"delete")})),$("[data-modal-confirm]").on("click",(function(t){t.preventDefault(),function(t,e){let a=t.attr("href"),c=new URLSearchParams(a);$.confirm({text:`请确认是否要${t.attr("title")}?`,callback:function(){$.request({url:a,type:e,data:0===Object.keys(c).length?null:c,callback:function(t){let e=parent.$("#global-modal .modal-body iframe");e.attr("src",e.attr("src")),parent.$.toast({title:t.msg,message:"请稍后数据刷新"})}})}})}($(this),"put")})),$("input.check-all").on("click",(function(){this.checked?$("input.check-opt").prop("checked",!0):$("input.check-opt").prop("checked",!1)})),$("input.check-opt").on("click",(function(){$("input.check-opt").length==$("input.check-opt:checked").length?$("input.check-all").prop("checked",!0):$("input.check-all").prop("checked",!1)})),$("a[data-batch]").on("click",(function(t){t.preventDefault();let e=$(this),a=$.checkedIds();$.confirm({text:"请确认是否要继续批量操作?",callback:function(){let t=e.attr("href")+"/"+a,c=new URLSearchParams(t);$.request({url:t,type:"post",data:0===Object.keys(c).length?null:c,callback:function(t){parent.$.reloadIFrame()}})}})}))}(window);
